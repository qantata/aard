datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

generator nexusPrisma {
  provider = "nexus-prisma"
}

model Library {
  id     String  @id
  root   String
  movies Movie[]
}

model Movie {
  id        String    @id
  title     String
  year      Int?
  file      VideoFile @relation(fields: [fileId], references: [id])
  fileId    String    @unique
  library   Library   @relation(fields: [libraryId], references: [id], onDelete: Cascade)
  libraryId String
}

model VideoFile {
  id             String               @id
  path           String
  rawProbeData   String
  probeData      String
  movie          Movie?
  streamSessions VideoStreamSession[]
}

model VideoStreamSession {
  id     String    @id
  file   VideoFile @relation(fields: [fileId], references: [id])
  fileId String
}
